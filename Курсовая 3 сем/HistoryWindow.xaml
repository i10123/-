<Window x:Class="QR_Generator.HistoryWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="История" Height="500" Width="450"
        WindowStyle="None" AllowsTransparency="True" Background="Transparent"
        WindowStartupLocation="CenterScreen">

	<Window.Resources>
		<!-- Стиль для элемента списка (Карточки) -->
		<Style TargetType="ListViewItem">
			<Setter Property="Background" Value="Transparent"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="ListViewItem">
						<Border x:Name="Bd"
                                Background="{TemplateBinding Background}"
                                BorderThickness="0"
                                Margin="0,0,0,8"
                                CornerRadius="8"
                                SnapsToDevicePixels="true">
							<ContentPresenter HorizontalAlignment="Stretch" VerticalAlignment="Center"/>
						</Border>
						<ControlTemplate.Triggers>
							<Trigger Property="IsMouseOver" Value="True">
								<!-- При наведении карточка чуть светлеет -->
								<Setter TargetName="Bd" Property="Background" Value="#333333"/>
							</Trigger>
							<Trigger Property="IsSelected" Value="True">
								<!-- При выделении красная рамка -->
								<Setter TargetName="Bd" Property="BorderBrush" Value="Red"/>
								<Setter TargetName="Bd" Property="BorderThickness" Value="1"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- Кнопка удаления (крестик) -->
		<Style x:Key="DeleteButtonStyle" TargetType="Button">
			<Setter Property="Background" Value="Transparent"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="Cursor" Value="Hand"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="Button">
						<Border Background="{TemplateBinding Background}" CornerRadius="4">
							<Path Data="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"
                                  Fill="Gray"
                                  Stretch="Uniform" Height="16" Width="16"
                                  x:Name="icon"/>
						</Border>
						<ControlTemplate.Triggers>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter TargetName="icon" Property="Fill" Value="Red"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>
	</Window.Resources>

	<Border Background="#FF1E1E1E" BorderBrush="Red" BorderThickness="1" CornerRadius="10">
		<Grid>
			<Grid.RowDefinitions>
				<RowDefinition Height="40"/>
				<!-- Заголовок -->
				<RowDefinition Height="*"/>
				<!-- Список -->
				<RowDefinition Height="60"/>
				<!-- Кнопки -->
			</Grid.RowDefinitions>

			<!-- Шапка (для перетаскивания) -->
			<Border Grid.Row="0" Background="Transparent" MouseLeftButtonDown="DragWindow">
				<StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
					<!-- Иконка часов -->
					<Path Data="M13.5,8H12V13L16.28,15.54L17,14.33L13.5,12.25V8M13,3A9,9 0 0,0 4,12H1L4.96,16.03L9,12H6A7,7 0 0,1 13,5A7,7 0 0,1 20,12A7,7 0 0,1 13,19C11.07,19 9.32,18.21 8.06,16.94L6.64,18.36C8.27,20 10.5,21 13,21A9,9 0 0,0 22,12A9,9 0 0,0 13,3"
                          Fill="Red" Height="20" Width="20" Stretch="Uniform" Margin="0,0,10,0"/>
					<TextBlock Text="ИСТОРИЯ" Foreground="White" FontSize="16" FontWeight="Bold" VerticalAlignment="Center"/>
				</StackPanel>
			</Border>

			<!-- Кнопка закрытия (справа сверху) -->
			<Button Grid.Row="0" Content="✕" HorizontalAlignment="Right" Width="30" Height="30"
                    Click="Close_Click" Background="Transparent" Foreground="Gray" BorderThickness="0" FontSize="16" Margin="0,0,5,0"/>

			<!-- Список карточек -->
			<ListView x:Name="listHistory" Grid.Row="1" Margin="10,5"
                      Background="Transparent" BorderThickness="0"
                      ScrollViewer.HorizontalScrollBarVisibility="Disabled">
				<ListView.ItemTemplate>
					<DataTemplate>
						<!-- Сама КАРТОЧКА -->
						<Border Background="#2D2D30" CornerRadius="6" Padding="10" Margin="0,0,0,0">
							<Grid>
								<Grid.ColumnDefinitions>
									<ColumnDefinition Width="Auto"/>
									<!-- Иконка -->
									<ColumnDefinition Width="*"/>
									<!-- Текст -->
									<ColumnDefinition Width="Auto"/>
									<!-- Кнопка удалить -->
								</Grid.ColumnDefinitions>

								<!-- Иконка QR -->
								<Border Grid.Column="0" Width="40" Height="40" Background="#111" CornerRadius="20" Margin="0,0,15,0">
									<Path Data="M3,11H5V13H3V11M11,21H13V23H11V21M21,11H23V13H21V11M15,13H17V15H15V13M19,19H21V21H19V19M13,3H21V11H13V3M15,5V9H19V5H15M3,3H11V11H3V3M5,5V9H9V5H5M3,13H11V21H3V13M5,15V19H9V15H5M13,13H15V15H13V13M13,17H15V19H13V17M17,17H19V19H17V17M17,13H19V15H17V13M19,15H21V17H19V15Z"
                                          Fill="White" Stretch="Uniform" Margin="10"/>
								</Border>

								<!-- Текст -->
								<StackPanel Grid.Column="1" VerticalAlignment="Center">
									<TextBlock Text="{Binding Content}" Foreground="White" FontSize="14" FontWeight="SemiBold" TextTrimming="CharacterEllipsis" ToolTip="{Binding Content}"/>
									<TextBlock Text="{Binding Date}" Foreground="#888" FontSize="12" Margin="0,3,0,0"/>
								</StackPanel>

								<!-- Кнопка удаления (пока просто визуально) -->
								<Button Grid.Column="2" Style="{StaticResource DeleteButtonStyle}"
                                        Click="BtnDelete_Click" Tag="{Binding}"
                                        ToolTip="Удалить запись"/>
							</Grid>
						</Border>
					</DataTemplate>
				</ListView.ItemTemplate>
			</ListView>

			<!-- Кнопки внизу -->
			<Button Grid.Row="2" Content="ОЧИСТИТЬ ВСЁ" Click="BtnClearAll_Click"
                    HorizontalAlignment="Left" Margin="20,0,0,0" Width="120" Height="35"
                    Background="#333" Foreground="#AAA" BorderBrush="#555" FontSize="12"/>

			<Button Grid.Row="2" Content="ЗАКРЫТЬ" Click="Close_Click"
                    HorizontalAlignment="Right" Margin="0,0,20,0" Width="120" Height="35"
                    Background="Red" Foreground="White" FontWeight="Bold"/>
		</Grid>
	</Border>
</Window>