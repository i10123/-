import cv2
import numpy as np

# Загружаем изображение
image = cv2.imread("5.png", cv2.IMREAD_GRAYSCALE)

# Построение ядра фильтра нижних частот
kernel_size = 5  # Размер ядра
# Создание усредняющего ядра
def create_low_pass_kernel(size):
    return np.ones((size, size), np.float32) / (size * size)
kernel = create_low_pass_kernel(kernel_size)

# Применяем ФНЧ (Используем экстраполяцию: копирование краевых пикселей)
low_pass_filter = cv2.filter2D(image, -1, kernel, borderType=cv2.BORDER_REPLICATE)

# ФВЧ (Вычисляем абсолютную разность между оригиналом и сглаженным изображением)
high_pass_filter = cv2.absdiff(image, low_pass_filter)

cv2.imwrite("LOW.png", low_pass_filter)
cv2.imwrite("HIGH.png", high_pass_filter)
